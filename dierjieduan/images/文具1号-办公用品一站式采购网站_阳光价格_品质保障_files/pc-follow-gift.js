/* 2019-10-24 */"use strict";window.MessageInfo=function(){var a="",b=3,c=0,d=null;this.info=function(c,e,f){a=c,b=e,d=f,this.addHtml()},this.success=function(c,e,f){a=c,b=e,d=f,this.addHtml("success")},this.waring=function(c,e,f){a=c,b=e,d=f,this.addHtml("waring")},this.error=function(c,e,f){a=c,b=e,d=f,this.addHtml("error")},this.loading=function(c,e,f){a=c,b=e,d=f,this.addHtml("loading")},this.addHtml=function(e){var f="",g=b||3,h=d||null,i=!0;c++,"loading"==e&&0==b&&(i=!1),e&&(f="message-"+e);var j=a||"请填写内容",k=$(".message-info-div"),l='<div class="message-info '+f+'" id="'+c+'"><i class="iconfont"></i><span>'+j+"</span></div>";k.length<=0?($("body").append('<div class="message-info-div"></div>'),$(".message-info-div").append(l),i&&this.fadeOut(c,g,h)):(k.append(l),i&&this.fadeOut(c,g,h))},this.hideLoading=function(a){return"slow"==a?(setTimeout(function(){$(".message-loading").addClass("message-info-out")},1e3),void setTimeout(function(){$(".message-loading").remove()},1400)):($(".message-loading").addClass("message-info-out"),void setTimeout(function(){$(".message-loading").remove()},400))},this.fadeOut=function(a,b,c){setTimeout(function(){$(".message-info[id="+a+"]").addClass("message-info-out"),setTimeout(function(){$(".message-info[id="+a+"]").remove(),c&&"function"==typeof c&&c()},400)},1e3*b)}};var pcEmailGetUrlParam=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b={},c=a||window.location.href,d=c.split("?");if(d[1]){var e=d[1].split("#")[0];if(e.indexOf("?")==-1)for(var f=decodeURI(e),g=f.split("&"),h=0;h<g.length;h++)b[g[h].split("=")[0]]=g[h].split("=")[1]}return b};$(function(){function a(){$(".pc-fg-popup").remove(),$("body").append("<div class='pc-fg-popup-follow'>\n      <div class='pfcpf-overlay'></div>\n      <div class='pfcpf-dialog'>\n        <div class='pfcpf-close'></div>\n        <div class='pfcpf-bg'>\n          <img src='"+n+"/img/pc/pc-follow-gift-07.png' />\n        </div>\n      </div>\n    </div>"),$(".pfcpf-close").on("click",function(){$(".pc-fg-popup-follow").remove(),b()})}function b(){$("body").append("<div class='pc-fg-popup'>\n      <div class='pfgp-overlay'></div>\n      <div class='pfgp-dialog'>\n        <div class='pcfg-close'></div>\n        <div class='pfgp-bg'></div>\n        <div class='pcfg-follow'></div>\n        <div class='pcfg-div'></div>\n      </div>\n    </div>"),$(".pcfg-close").on("click",function(){$(".pc-fg-popup").hide()}),$(".pcfg-follow").on("click",function(){a()}),$(".pcfg-div").on("click",function(){var a=(new Date).getTime(),b=hex_md5("wjyh2018"+a),c=h.f;$.ajax({url:j+"/index.php?app=cron/MobileApi&r=user_status&key="+b+"&time="+a+(c?"&f="+c:""),type:"GET",dataType:"jsonp",jsonpCallback:"callback1",success:function(a){a&&200==a.code?u("old"):201==a.code?($(".pc-fg-popup").remove(),v()):g.error(a.msg)},error:function(a){g.error(a)}})})}function c(){m("activityF")?($("body").append("<div class='pc-follow-gift-logo'></div>"),$(".pc-follow-gift-logo").on("click",function(){b()}),$(".pc-follow-gift-logo").click()):"email"===h.f&&($("body").append("<div class='pc-follow-gift-logo'></div>"),$(".pc-follow-gift-logo").on("click",function(){b()}),$(".pc-follow-gift-logo").click())}function d(){var a=(new Date).getTime(),b=hex_md5("wjyh2018"+a),d=h.f;$.ajax({url:j+"/index.php?app=cron/MobileApi&r=user_status&key="+b+"&time="+a+(d?"&f="+d:""),type:"GET",dataType:"jsonp",jsonpCallback:"callback20",success:function(a){a&&a.data&&1==a.data.popup&&c()},error:function(a){console.log(a)}})}var e=null,f=60,g=null;window.MessageInfo&&(g=new window.MessageInfo);var h=pcEmailGetUrlParam(),i=window.location.host,j="",k="",l="";switch(i){case"m.wjyh.com":j="//www.wjyh.com",k="//www.wjyh.com",l="//www.wjyh.com";break;case"m.test.wjyh.com":j="//www.test.wjyh.com",k="//www.wjyh.com",l="//www.test.wjyh.com";break;case"m.dev.wjyh.com":j="//www.dev.wjyh.com",k="//www.wjyh.com",l="//www.dev.wjyh.com";break;case"www.wjyh.com":j="//www.wjyh.com",k="//www.wjyh.com",l="//www.wjyh.com";break;case"dev.wjyh.com":j="//www.dev.wjyh.com",k="//www.wjyh.com",l="//www.dev.wjyh.com";break;default:j="//www.dev.wjyh.com",k="//www.wjyh.com",l="//www.dev.wjyh.com"}var m=function(a){var b=null,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null},n="/views/www.mobile/",o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=n+"css/pc-follow-gift.css",document.getElementsByTagName("head")[0].appendChild(o);var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.href=n+"css/pc-message.css",document.getElementsByTagName("head")[0].appendChild(p);var q=document.createElement("script");q.src=n+"js/dest/md5.js",q.onload=function(){d()},document.body.appendChild(q);var r=function(a){var b=/^1(3|4|5|6|7|8|9)\d{9}$/;return""===a?(g.error("请输入手机号"),!1):b.test(a)?a:(g.error("手机号不正确"),!1)},s=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$("body").append("<div class='pc-fg-popup-new'>\n      <div class='pfgpn-overlay'></div>\n      <div class='pfgpn-dialog'>\n        <div class='pfgpn-close'></div>\n        <h1>领取成功</h1>\n        <h2>恭喜您！<br />“688元现金礼品券”已放入您的会员账户中</h2>\n        <h3>会员账户名："+a+"</h3>\n        <h3>初始账户密码：888888</h3>\n        <div class='line'></div>\n        <h4>您可在网站的<a class='change-pass-a'>会员中心-隐私设置</a>中修改密码</h4>\n        <div class='popup-footer'>\n          <a class='go-buy'>去购物</a>\n          <a class='look-my'>查看我的礼品券</a>\n        </div>\n      </div>\n    </div>"),$(".pfgpn-close").on("click",function(){$(".pc-fg-popup-new").remove()}),$(".change-pass-a").on("click",function(){$(".pc-fg-popup-new").remove(),window.location.href="https://www.wjyh.com/bBMember-resetpwd.html"}),$(".go-buy").on("click",function(){$(".pc-fg-popup-new").remove(),window.location.href="https://www.wjyh.com"}),$(".look-my").on("click",function(){$(".pc-fg-popup-new").remove(),window.location.href="https://www.wjyh.com/bBMember-my_card.html"})},t=function(){$("body").append("<div class='pc-fg-popup-old'>\n      <div class='pfgpo-overlay'></div>\n      <div class='pfgpo-dialog'>\n        <div class='pfgpo-close'></div>\n        <h1>领取成功</h1>\n        <h2>恭喜您！<br />“688元现金礼品券”已放入您的会员账户中</h2>\n        <div class='popup-footer'>\n          <a class='go-buy'>去购物</a>\n          <a class='look-my'>查看我的礼品券</a>\n        </div>\n      </div>\n    </div>"),$(".pfgpo-close").on("click",function(){$(".pc-fg-popup-old").remove()}),$(".go-buy").on("click",function(){$(".pc-fg-popup-old").remove(),window.location.href="https://www.wjyh.com"}),$(".look-my").on("click",function(){$(".pc-fg-popup-old").remove(),window.location.href="https://www.wjyh.com/bBMember-my_card.html"})},u=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(g.loading("领取中..."),"new"===a){var d=(new Date).getTime(),e=hex_md5("wjyh2018"+d),f="email";$.ajax({url:j+"/index.php?app=cron/MobileApi&r=mobile_login&key="+e+"&time="+d+"&m="+b+"&password=&smscode="+c+"&login_type=vaild&f="+f,type:"GET",dataType:"jsonp",jsonpCallback:"callback4",success:function(a){g.hideLoading(),setTimeout(function(){switch(a.err){case 0:a.data?a.data.username&&($(".pc-fg-popup-verify").remove(),s(a.data.username)):($(".pc-fg-popup-verify").remove(),t());break;case 100:g.error("用户名或密码不能为空");break;case 101:g.error("用户名或密码不正确");break;case 102:g.error("该账号已被禁用");break;case 103:g.error("用户名或密码不正确");break;case 109:g.error("验证码错误，请重试！"),$(".pfgpv-code").val("");break;case 1:g.error("验证码错误，请重试！"),$(".pfgpv-code").val("");break;case 11100:$(".pc-fg-popup-verify").remove(),t();break;case 1105:$(".pfgpv-code").val("");break;default:g.error(a.message)}},400)},error:function(a){g.hideLoading(),setTimeout(function(){g.fail("领取失败")},400)}})}else{var h=(new Date).getTime(),i=hex_md5("wjyh2018"+h),k="email";$.ajax({url:j+"/index.php?app=cron/MobileApi&r=mobile_gain_coupon&key="+i+"&time="+h+"&f="+k,type:"GET",dataType:"jsonp",jsonpCallback:"callback5",success:function(a){g.hideLoading(),setTimeout(function(){switch(a.code){case 200:$(".pc-fg-popup").remove(),t();break;case 1105:g.error(a.msg,5),setTimeout(function(){$(".pc-fg-popup").hide()},5e3);break;default:g.error(a.msg)}},400)},error:function(a){g.hideLoading(),setTimeout(function(){g.fail("领取失败")},400)}})}},v=function(){var a=!0;$("body").append("<div class='pc-fg-popup-verify'>\n      <div class='pfgpv-overlay'></div>\n      <div class='pfgpv-dialog'>\n        <div class='pfgpv-close'></div>\n        <h1>请先进行手机验证</h1>\n        <div class='pfgpv-form-content'>\n          <h3>请输入手机号</h3>\n          <input class='pfgpv-phone' maxlength='11' />\n          <div class='pfgpv-code-content'>\n            <h3>请输入验证码</h3>\n            <div class='pfgpvc-other'>\n              <input class='pfgpv-code' />\n              <a class='pfgpv-code-a'>获取验证码</a>\n            </div>\n          </div>\n        </div>\n        <a class='pfgpv-receive-a'>领取礼包</a>\n        <div class='pfgpv-checkbox clearfix'>\n          <input class='pfgpv-checkbox-input' type='checkbox' value='' checked />\n          <label for='checkbox' class='pfgpv-checkbox-label'>同意 <a href=\"https://www.wjyh.com/mMRegister-agreement.html\">《文具1号服务协议》</a></label>\n        </div>\n      </div>\n    </div>"),$(".pfgpv-close").on("click",function(){$(".pc-fg-popup-verify").hide()}),$(".pfgpv-code-a").on("click",function(){if(a){var b=$(".pfgpv-phone").val(),c=r(b);if(c){a=!1;var d=(new Date).getTime(),h=hex_md5("wjyh2018"+d);$.ajax({url:j+"/index.php?app=cron/MobileApi&r=mobile_code&key="+h+"&time="+d,type:"GET",dataType:"jsonp",jsonpCallback:"callback2",success:function(c){if(200==c.code){var i=c.data.code;$.ajax({url:j+"/index.php?app=cron/MobileApi&r=mobile_validate_code&key="+h+"&time="+d+"&m="+b+"&code="+i+"&type=mobileLogin",type:"GET",dataType:"jsonp",jsonpCallback:"callback3",success:function(b){if(0==b.err){if(g.success("发送成功请查收"),e)return;e=setInterval(function(){f--,$(".pfgpv-code-a").addClass("disabled").html(f+"s后重新获取"),f<=0&&(clearInterval(e),e=null,f=60,a=!0,$(".pfgpv-code-a").removeClass("disabled").html("重新获取"))},1e3)}else a=!0,g.error(b.message)},error:function(){a=!0,g.error("接口拥堵，请刷新页面再试")}})}else a=!0,g.error(c.msg)},error:function(){a=!0,g.error("接口拥堵，请刷新页面再试")}})}}}),$(".pfgpv-receive-a").on("click",function(){var a=$(".pfgpv-phone").val(),b=r(a),c=$(".pfgpv-code").val();if(b)return""===c?void g.error("请输入验证码"):$(".pfgpv-checkbox-input").is(":checked")?void u("new",b,c):void g.error("请同意《文具1号服务协议》")}),$(".pfgpv-checkbox-label").click(function(){$(".pfgpv-checkbox-input").click()})}});